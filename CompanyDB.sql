-- CREATE A DATABASE

CREATE DATABASE CompanyDB
USE CompanyDB

-- CREATE EMP TABLE
CREATE TABLE EMP(
					SSN INT PRIMARY KEY,
					FName NVARCHAR(10),
					LName NVARCHAR(10),
					SVID INT,
					Gender NVARCHAR(1),
					Birthday DATE,
					FOREIGN KEY (SVID) REFERENCES EMP(SSN)
				)	
ALTER TABLE EMP
ADD DNum INT
ALTER TABLE EMP
ADD FOREIGN KEY (DNum) REFERENCES DEPT(DNum)
-- CRAETE DEPT TABLE
CREATE TABLE DEPT (
					    DNum INT PRIMARY KEY,
						DName NVARCHAR(20),
						MGR_SSN INT,
						HiringDate DATE,
						FOREIGN KEY (MGR_SSN) REFERENCES EMP(SSN)
	
					)


-- CREATE LOC TABLE 
CREATE TABLE LOC(
					LOCID INT PRIMARY KEY,
					DNum INT,
					DLoc NVARCHAR(20),
					FOREIGN KEY (DNum) REFERENCES DEPT(DNum)
				)

-- CREATE PROJECT TABLE
CREATE TABLE PROJECT(
						PNum INT PRIMARY KEY,
						DNum INT,
						PName NVARCHAR(50),
						City NVARCHAR(20),
						Locations NVARCHAR(20),
						FOREIGN KEY (DNum) REFERENCES DEPT(DNum)
					)

-- CREATE WORK TABLE
CREATE TABLE WORK(
					SSN INT,
					PNum INT,
					Hrs INT,
					PRIMARY KEY (SSN, PNum),
					FOREIGN KEY (SSN) REFERENCES EMP(SSN),
					FOREIGN KEY (PNum) REFERENCES PROJECT(PNum)
				)

-- CREATE DEPENDENT TABLE
CREATE TABLE DPNT(
					SSN INT,
					DEPNTName NVARCHAR(50) NOT NULL,
					Gender NVARCHAR(1),
					Birthday DATE,
					PRIMARY KEY (SSN, DEPNTName),
					FOREIGN KEY (SSN) REFERENCES EMP(SSN)
					)



SELECT * FROM DEPT
SELECT * FROM EMP
SELECT * FROM LOC
SELECT * FROM PROJECT
SELECT * FROM WORK
SELECT * FROM DPNT

-- INSERT EMP
INSERT INTO EMP (SSN, FName, LName, SVID, Gender, Birthday)
VALUES
(1001, 'John', 'Smith', 1002, 'M', '1985-03-10'),
(1002, 'Aisha', 'Khalid', 1001, 'F', '1990-06-25')


-- INSERT DEPT
INSERT INTO DEPT (DNum, DName, MGR_SSN, HiringDate)
VALUES
(1, 'Engineering', NULL, '2012-01-01'),
(2, 'Human Resources', 1002, '2015-06-15')
UPDATE EMP SET SVID = 1002 WHERE SSN = 1001


-- INSERT LOCATIONS
INSERT INTO LOC (LOCID, DNum, DLoc)
VALUES
(101, 1, 'Muscat'),
(102, 2, 'Salalah')

-- INSERT PROJECTS
INSERT INTO PROJECT (PNum, DNum, PName, City, Locations)
VALUES
(201, 1, 'AI Platform', 'Muscat', 'HQ'),
(202, 2, 'Recruitment System', 'Salalah', 'Branch A')

-- INSERT WORK
INSERT INTO WORK (SSN, PNum, Hrs)
VALUES
(1001, 201, 40),
(1002, 202, 35)

-- INSERT DEPENDENT
INSERT INTO DPNT (SSN, DEPNTName, Gender, Birthday)
VALUES
(1001, 'Laila', 'F', '2010-08-14'),
(1002, 'Omar', 'M', '2012-12-25')

